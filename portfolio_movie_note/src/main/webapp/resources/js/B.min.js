/*! Brunch-Web 2019-06-24 */
jQuery?(jQuery.noConflict(),jQuery.userAgent=daumtools.userAgent(),window._platform&&(jQuery.userAgent.platform=window._platform)):alert("jQuery를 로드해주세요"),window.B={version:"0.1",isMobile:function(){return"mobile"==B.UserAgent.platform},initKeyword:function(a){var b=jQuery(".popular-keyword"),c="on";b.on("click",function(){var d=jQuery(this).attr("data-id");b.removeClass(c),jQuery(this).addClass(c),jQuery(".list_writers_group").hide(),jQuery(".writer_"+d).show(),B.isMobile()&&_tiq.push(["__trackEvent","mw","m_writers"]),a&&a()}),jQuery(".brunch_keyword_item_button").on("click",function(a){a.preventDefault();var b="/keyword/profile/"+jQuery(this).attr("data-keyword");window.open(b,"_blank")}),jQuery(".link_slide_writer").on("click",function(a){B.isMobile()&&_tiq.push(["__trackEvent","mw","m_writers"])}),jQuery(".brunch_keyword_item_more_button").on("click",function(a){a.preventDefault();var b=jQuery(this).attr("data-url");window.open(b,"_blank")})},cookie:{firstPublishShare:"firstPublishShare",firstDraftSave:"firstDraftSave",firstBrunchbookPublishShare:"firstBrunchbookPublishShare"},preSettings:{minScrollWidth:940},localStorageKey:{viewArticleUid:"viewArticleUid",referrer:"listViewReferrer",feed:{listData:"feedArticleList",clickArticleUid:"feedClickArticleUid",lastTime:"feedLastCreateTimeParam"},feed_magazine:{listData:"feedMagazineList",clickArticleUid:"feedClickMagazineUid",lastTime:"feedMagazineLastCreateTimeParam"},feed_following:{listData:"feedFollowingList",clickArticleUid:"feedClickFollowingUid",lastTime:"feedFollowingListLastCreateTimeParam"},home:{listData:"homeArticleList",clickArticleUid:"homeClickArticleUid",lastTime:"homeLastCreateTimeParam"},home_image:{listData:"homeArticleImageTypeList",clickArticleUid:"homeClickArticleImageTypeUid",lastTime:"homeImageTypeLastCreateTimeParam"},magazine:{listData:"magazineArticleList",clickArticleUid:"magazineClickArticleUid",lastTime:"magazineLastCreateTimeParam"},now:{listData:"nowArticleList",clickArticleUid:"nowClickArticleUid",lastTime:"nowLastCreateTimeParam"},likeit:{listData:"likeitArticleList",lastTime:"likeitLastCreateTimeParam",clickArticleUid:"likeitClickArticleUid"},pod:{visit:"pod_visit"},search:{queries:"searchQueries"}},headerMenu:{$serviceHeader:jQuery(".service_header"),$btnSearch:jQuery("#btnServiceMenuSearch"),$searchQuery:jQuery("#searchQuery"),$btnToggleArticleMoreAction:jQuery("#btnToggleArticleMoreAction"),$writeButton:jQuery(".service_header .btn_write"),classNames:{headerHeadMenubar:"header_head_menubar",scrollBeyond:"beyond_content",toggleArticleMoreAction:"show_more_action"},init:function(){this.$btnSearch.on("click",jQuery.proxy(this.showSearchArea,this))},showSearchArea:function(a){var b=jQuery(a.target);if("/"!=location.pathname){var c=this.$searchQuery;if(b.parent().hasClass("show"))return this.$searchQuery.focus(),!1;this.animateForm(b,c)}else B.searchLayer.init()},animateForm:function(a,b){jQuery("#searchQuery").css("opacity","0"),a.parent().addClass("show"),this.$writeButton.addClass("show"),a.css("margin-right","17px"),b.css("margin-left","80px"),a.animate({"margin-right":"172px"},200,function(){jQuery("#searchQuery").css("opacity","1")}),b.animate({"margin-left":"37px"},300,function(){}),this.$searchQuery.focus()},initArticleMoreAction:function(){this.$btnToggleArticleMoreAction.on("click",jQuery.proxy(this.toggleArticleMoreActionClassName,this)),jQuery("#btnEditBrunchbookArticle").on("click",jQuery.proxy(B.Article.editBrunchbookArticle,B.Article)),jQuery("#btnDeleteArticle").on("click",jQuery.proxy(B.Article.deleteArticle,B.Article)),jQuery("#btnPrivateArticle").on("click",jQuery.proxy(B.Article.privateArticle,B.Article)),jQuery("#btnPublishArticle").on("click",jQuery.proxy(B.Article.clickPublishButton,B.Article)),jQuery("#btnCancleArticle").on("click",jQuery.proxy(B.Article.clickCancelReservationButton,B.Article))},toggleArticleMoreActionClassName:function(){this.$btnToggleArticleMoreAction.parent().toggleClass(this.classNames.toggleArticleMoreAction)},initScrollMenuForPage:function(a){jQuery(window).on("scroll",jQuery.proxy(this.controlScroll,this,a))},controlScroll:function(a){if(a in{home:1,ready:1,history:1,setting:1,stats:1,feed:1,search:1,magazine:1,now:1,likeit:1,apply:1,propose:1})var b=jQuery("."+this.classNames.headerHeadMenubar).height();if("subscription"==a)var b=jQuery(".header_head_menubar").offset().top;if("likeUsers"==a||"bookPrize"==a)var b=jQuery(".header_head_menubar").offset().top;if("write"==a)var b=jQuery(".wrap_cover").height();if("stats"==a)var b=jQuery(".cont_statistic").offset().top;if("search"==a)var b=jQuery(".cont_search").offset().top;if("top"==a)var b=jQuery(".editor_pic").offset().top;if("brunchbookEntry"==a)var b=jQuery(".cont_brunchbook_entry").offset().top;if("keywordSub"==a)var b=jQuery(".wrap_contents").offset().top;if("publish"==a)var b=jQuery(".wrap_list_award").offset().top;if("apply"==a)var b=10;jQuery(window).scrollTop()>b?(this.$serviceHeader.addClass(this.classNames.scrollBeyond),"search"==a&&jQuery(".wrap_btn_search").addClass("show"),"search"==a&&jQuery("#btnServiceMenuSearch").css("margin-right","172px"),"publish"==a&&jQuery(".book_request").removeClass("book_request_link"),"apply"==a&&this.$serviceHeader.removeClass("white_header")):(this.$serviceHeader.removeClass(this.classNames.scrollBeyond),"search"==a&&jQuery(".wrap_btn_search").removeClass("show"),"search"==a&&jQuery("#btnServiceMenuSearch").css("margin-right",0),"publish"==a&&jQuery(".book_request").addClass("book_request_link"),"apply"==a&&this.$serviceHeader.addClass("white_header"))}},sideMenu:{$serviceHeader:jQuery(".service_header"),$btnServiceMenu:jQuery("#btnServiceMenu"),$wrapSideMenu:jQuery("#wrapSideMenu"),$btnCloseSideMenu:jQuery("#btnCloseSideMenu"),init:function(){this.$btnServiceMenu.on("click",jQuery.proxy(this.openSideMenu,this)),this.$btnCloseSideMenu.on("click",jQuery.proxy(this.closeSideMenu,this)),jQuery(window).on("resize load",jQuery.proxy(this.resizeMenuHeight,this)),jQuery(window).on("keydown",jQuery.proxy(this.keydownHandler,this)),jQuery(window).on("mousedown touchend",jQuery.proxy(this.mousedownHandler,this)),this.initSetLoginOutUrl(),this.checkNewAlert(),this.initRemoveLocalStorageData(),this.initApplyAuthor()},openSideMenu:function(){this.$wrapSideMenu.addClass("open")},closeSideMenu:function(){this.$wrapSideMenu.removeClass("open")},initSetLoginOutUrl:function(){var a=location.pathname,b="/signin?url="+encodeURIComponent(a);if(/^\/search/.test(a)){var c=location.search;c&&(b="/signin?url="+encodeURIComponent(a+c))}B.SocialUser&&B.SocialUser.check&&(b="/signout?url="+encodeURIComponent(b)),jQuery("#brunchSigninButton").attr("href",b),jQuery("#sideMenuLogoutButton").attr("href","/signout?url=%2F"),jQuery("#rememberMe").on("change",function(a){var b=!!a.target.checked;jQuery.cookie("IRM",b?"1":"0"),b?jQuery("#rememberMeLabel .ico_brunch").addClass("ico_choiced"):jQuery("#rememberMeLabel .ico_brunch").removeClass("ico_choiced")}),1==jQuery.cookie("IRM")?jQuery("#rememberMe").attr("checked",!0):jQuery("#rememberMe").attr("checked",!1),jQuery("#rememberMe").trigger("change")},resizeMenuHeight:function(a){var b=jQuery(window).height(),c=jQuery("#wrapSideMenu .wrap_side_service_menu"),d=jQuery("#wrapSideMenu .wrap_side_setting"),e=730,f=427;if(0!=jQuery(".menu_side_banner").length&&(e=857,f=592),b<e){d.css("position","inherit");var g=e-b,h=f-g;h>=276&&c.height(h)}else d.css("position","absolute")},keydownHandler:function(a){a&&a.keyCode&&27==a.keyCode&&this.closeSideMenu()},mousedownHandler:function(a){0==jQuery(a.target).closest("#wrapSideMenu").length&&this.closeSideMenu()},checkNewAlert:function(){if(B.User&&B.User.userId&&!(window.location.href.indexOf("/me/history")>-1)){var a=this;B.Util.ajax({xhrFields:{withCredentials:!0},crossDomain:!0,type:"GET",url:B.Config.apiUrl+"/v1/history/new",success:function(b){b.data&&b.data.count>0?a.showNewAlert():a.hideNewAlert()},error:function(a){return!0}})}},hideNewAlert:function(){this.$serviceHeader.removeClass("new"),this.$btnServiceMenu.removeClass("new"),this.$wrapSideMenu.removeClass("new")},showNewAlert:function(){this.$serviceHeader.addClass("new"),this.$btnServiceMenu.addClass("new"),this.$wrapSideMenu.addClass("new")},initRemoveLocalStorageData:function(){jQuery(".wrap_side_service_menu .brunchHomeLink").on("click",function(){B.Util.localStorage.remove(B.localStorageKey.home.listData)}),jQuery(".wrap_side_service_menu .brunchHomeLink").on("click",function(){B.Util.localStorage.remove(B.localStorageKey.home_image.listData)}),jQuery(".wrap_side_service_menu .brunchFeedLink").on("click",function(){B.Util.localStorage.remove(B.localStorageKey.feed.listData)}),jQuery(".wrap_side_service_menu .brunchNowLink").on("click",function(){B.Util.localStorage.remove(B.localStorageKey.now.listData)}),jQuery(".wrap_side_service_menu .brunchLikeLink").on("click",function(){B.Util.localStorage.remove(B.localStorageKey.likeit.listData)})},initApplyAuthor:function(){null!=B.User&&"false"==B.User.emailValidation&&jQuery(".btn_apply_author").on("click",function(a){B.Message.showMessage("#error:needEmailValidation"),a.preventDefault()})}},searchLayer:{$body:jQuery("body"),layerTypeGuide:"layer_guide",layerTypeSearch:"layer_search",searchTypes:["article","magazine","user"],typing:"",lastQuery:"",initElement:function(){jQuery.extend(this,{$layer:jQuery("#searchLayer"),$sideMenu:jQuery("#wrapSideMenu"),$searchGuide:jQuery("#suggestGuide"),$searchTitle:jQuery("#suggestSearch .tit_suggest a"),$searchInput:jQuery(".wrap_search .search_form #txt_search"),$searchBtn:jQuery("#btnServiceMenuSearch .ico_search"),$logo:jQuery("#searchLayer .btn_close, #searchLayer .logo_service"),$guideTxt:jQuery(".suggest_guide p.desc_g"),$menuBtn:jQuery("#searchLayer #btnServiceMenu")})},init:function(){var a=this;jQuery.get(B.Config.apiUrl+"/v1/search/guide",function(b){b.data.guideText=b.data.guideText,null!=a.$layer&&void 0!==a.$layer||(a.$body.prepend(jQuery(B.Util.getTemplate("search-pc-intro.hbs",b.data))),a.$body.find(".wrap_list").append(jQuery(B.Util.getTemplate("search-pc-intro-recommends.hbs",b.data))),a.$body.addClass("brunch_suggest"),a.initElement(),a.$logo.on("click",jQuery.proxy(a.downSearchArea,a)),a.$guideTxt.html(b.data.guideText),a.$layer.addClass(a.layerTypeGuide),a.initLive(),a.$body.prepend(a.$body.find("#wrapSideMenu")),a.$menuBtn.on("click",function(){a.$sideMenu.addClass("open")}),jQuery(".recmd_keyword").each(function(){jQuery(this).on("click",function(a){a.preventDefault(),location.href="/search?q="+encodeURIComponent(b.data.guideQuery)+"&k="+encodeURIComponent(jQuery(this).text())+"&type=user"})}))})},initLive:function(){var a=this;this.$searchInput.on("keyup",function(b){b.preventDefault();var c=jQuery("#txt_search").val().trim(),d=jQuery(this);""==c?d.css("background-color","transparent"):d.css("background-color","#fff"),a.$layer.hasClass(a.layerTypeSearch)||(a.$layer.addClass(a.layerTypeSearch),a.$layer.removeClass(a.layerTypeGuide)),13==b.keyCode&&""!=c?a.$searchBtn.click():a.typing=setTimeout(function(){a.lastQuery!=c&&a.liveSearch(c,a),a.lastQuery=c},200)}),this.$searchInput.on("keydown",function(b){clearTimeout(a.typing)}),this.$searchBtn.on("click",jQuery.proxy(this.moveToSearch,this)),this.$searchTitle.on("click",function(b){b.preventDefault(),a.moveToSearch(jQuery(this).data("type"))}),this.initSearchInput()},initSearchInput:function(){var a=this.$searchInput.clone().addClass("placeholder").val(this.$searchInput.attr("placeholder")),b=jQuery('<span class="placeholder-container"></span>');b.insertAfter(this.$searchInput).append(this.$searchInput).append(a),b.css({position:"relative"}),this.$searchInput.css({position:"absolute",zIndex:10,backgroundColor:"transparent",borderColor:"transparent"}),a.css("color","transparent"),this.$searchInput.focus(function(){var a=jQuery(this);jQuery(".placeholder",a.parent()).css("color","#fbfbfb")}).blur(function(){var a=jQuery(this),b=jQuery(".placeholder",a.parent());""==a.val()&&b.css("color","transparent")}),this.$searchInput.focus()},moveToSearch:function(a){var b=this.$searchInput.val().trim();if(""!=b){var c="/search?q="+encodeURIComponent(b);(void 0!==a&&"article"==a||"magazine"==a||"user"==a)&&(c=c+"&type="+a),window.location=c}},liveSearch:function(a,b){""==a?(b.$layer.removeClass(b.layerTypeSearch),b.$layer.addClass(b.layerTypeGuide)):(b.$layer.removeClass(b.layerTypeGuide),b.$layer.addClass(b.layerTypeSearch),jQuery.get(B.Config.apiUrl+"/v1/search/live?q="+encodeURIComponent(a),function(a){b.searchTypes.forEach(function(c){var d=a.data[c];if(null!=d&&d.length>0){var e=d;d={},d[c]=e}else d={nodata:!0};b.drawLiveSearch(c,d)})}))},drawLiveSearch:function(a,b){var c=jQuery(".intro-"+a+"-item");c.empty(),c.html(B.Util.getTemplate("search-pc-intro-item.hbs",b)),c.find(".item_recommend_title").each(function(){jQuery(this).html(jQuery(this).text())})},downSearchArea:function(a){a.preventDefault(),jQuery("#searchLayer").remove(),this.$body.removeClass("brunch_suggest"),this.$layer=null}},M:{},Post:{},Comment:{},Home:{},Magazine:{},Related:{},Template:{},History:{},Config:{},Sign:{},User:null,Keyword:{},getUser:function(a,b){var a=a||function(a,b){};if(this.data&&!b)return B.isDebug(),void a(this.data);B.Util.ajax({url:B.Config.apiUrl+"/v1/me",type:"get",success:function(b){B.User=b.data,B.isDebug(),a(b.data)},error:function(b){B.isDebug(),a(null,b)}})},getKakaoLinkData:function(a){var b=a.objectType||"feed",c=[{title:"웹으로 보기",link:{mobileWebUrl:a.link,webUrl:a.link}},{title:"앱으로 보기",link:{mobileWebUrl:a.link,webUrl:a.link,androidExecParams:a.appContext.appParamString,iosExecParams:a.appContext.appParamString}}];void 0!==a.kakaoPrefix&&""!=a.kakaoPrefix&&(a.prefix=a.kakaoPrefix),void 0!==a.kakaoDescription&&""!=a.kakaoDescription&&(a.description=a.kakaoDescription),void 0!==a.kakaoImage&&""!=a.kakaoImage.src&&(a.image=a.kakaoImage);var d=null;"list"==b?d={objectType:"list",headerTitle:a.prefix,headerLink:{mobileWebUrl:a.link,webUrl:a.link},contents:a.listContents,buttons:c,headerImageUrl:a.headerImageUrl,headerTitle:a.headerTitle}:(d={objectType:"feed",content:{title:a.prefix,description:a.description||"",imageUrl:a.image.src,link:{mobileWebUrl:a.link,webUrl:a.link,androidExecParams:a.appContext.appParamString,iosExecParams:a.appContext.appParamString}},buttons:c},a.image.width&&a.image.height&&(d.content.imageWidth=a.image.width,d.content.imageHeight=a.image.height));try{var e=jQuery("#articleUserId").val(),f=jQuery("#articleNo").val();if(e&&f){var g={userId:e,articleNo:f};d.serverCallbackArgs=B.Util.stringify(g)}}catch(h){}return d},isDebug:function(){return"dev"==B.Config.active||"local"==B.Config.active},webToApp:function(a,b){function c(){alert("파라미터가 올바르지 않음")}function d(){return new RegExp(p.join("|"),"i").test(l.ua)}function e(){var a=jQuery.userAgent;return"ios"==a.os.name&&parseInt(a.os.version.major,10)>8&&a.ua.indexOf("safari")>0}function f(a,b,c){var d=e(),f=d?1300:600,g=d?1100:400,h=+new Date,i=function(){+new Date-h<f&&c(b)},j=window.setTimeout(function(){i()},g);if(window.addEventListener("pagehide",function(){window.clearTimeout(j)}),d)window.location=a;else{var k=document.createElement("iframe");document.body.appendChild(k),k.style.display="none",k.setAttribute("src",a),k.onload=i}}function g(){var a=[6,6,1],b=/naver\s*\(\s*[^;]*;\s*[^;]*\s*;\s*[^;]*\s*;\s*([0-9]+\.[0-9]+\.[0-9]+).*\)/i,c=window.navigator.userAgent||"";if(c&&b.test(c)){var d=c.match(b);if(d&&2==d.length){var e=d[1];if(e){var f=e.split(".");if(3==f.length){var g=!0;if(jQuery(f).each(function(a,b){var c=parseInt(b,10);isNaN(c)?g=!1:f[a]=c}),g){var h=a;for(var i in h){if(f[i]<h[i])return!1;if(f[i]>h[i])return!0}return!0}}}}}return!1}function h(a){if(g()){var b=document.getElementById("androidIntent");b||(b=k("androidIntent")),b.src=a}else window.location=a}function i(a,b,c){var d=(new Date).getTime();setTimeout(function(){var a=(new Date).getTime();j()&&a-d<600&&c(b)},400),k("appLauncher").src=a}function j(){return void 0===document.webkitHidden||!document.webkitHidden}function k(a){var b=document.createElement("iframe");return b.id=a,b.style.border="none",b.style.width="0",b.style.height="0",b.style.display="none",b.style.overflow="hidden",document.body.appendChild(b),b}var l=jQuery.userAgent,m=l.os;if(!a.urlScheme){if(a.flag)switch(a.flag){case"view":if(!a.userId||!a.articleNo)return c(),!1;break;case"profile":if(!a.userId)return c(),!1;break;case"magazine":if(!a.magazineNo)return c(),!1;break;case"comment":if(!a.userId||!a.articleNo)return c(),!1;break;case"search":break;case"brunchbook":if(!a.brunchbookNo)return c(),!1}var n="";for(var o in a)n+="flag"==o?"?":"&",n+=o+"="+a[o];a={urlScheme:"brunchapp://open"+n,storeURL:m.android?"market://details?id=com.daumkakao.android.brunchapp":"https://itunes.apple.com/app/id1001388574",intentUri:"intent://open"+n+"#Intent;scheme=brunchapp;package=com.daumkakao.android.brunchapp;end",onUnsupportedCallback:a.onUnsupportedCallback,appParamString:n.split("?").join(""),onAppMissing:a.onAppMissing}}if(b)return a;var p=["firefox","opera"],q=function(a){window.location=a},r="function"==typeof a.willInvokeApp?a.willInvokeApp:function(){},s="function"==typeof a.onAppMissing?a.onAppMissing:q,t="function"==typeof a.onUnsupportedCallback?a.onUnsupportedCallback:function(){};r(),m.android?d()||a.useUrlScheme?a.storeURL&&i(a.urlScheme,a.storeURL,s):a.intentUri&&h(a.intentUri,s):m.ios&&a.storeURL?f(a.urlScheme,a.storeURL,s):t()}},jQuery(function(){"mobile"!=jQuery.userAgent.platform&&(B.headerMenu.init(),B.sideMenu.init())}),function(){try{var a={error:function(){},log:function(){},debug:function(){},info:function(){},warn:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){}};window.console=window.console||a;for(var b in a)window.console[b]||(window.console[b]=a[b])}catch(c){}}(),window.onerror=function(a,b,c){window.event;return B.isDebug()||Raven.captureException(a,b,c),!0},function(a){a.fn.blink=function(){a(this).fadeOut(250).fadeIn(250)},a.fn.exists=function(){return this.size()>0},a.fn.notExists=function(){return 0==this.size()},a.isUndefinedOrNull=function(a){return void 0===a||null==a},a.fn.isVisible=function(){return a(this).is(":visible")},a.fn.isHidden=function(){return a(this).is(":hidden")},a.fn.isAnimated=function(){return a(this).is(":animated")},a.fn.isNotAnimated=function(){return!a(this).isAnimated()}}(jQuery);